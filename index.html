<!DOCTYPE html>      
<html lang="id">      
<head>      
<meta charset="UTF-8">      
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">      
<title>Dollar App – Login</title>      

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">      

<style>      
    /* ======================== BODY ======================== */      
    body {      
        margin:0;      
        padding:0;      
        font-family:'Inter', sans-serif;      
        background:#f1f5f9;      

        display:flex;      
        flex-direction: column;    
        justify-content:center;      
        align-items:center;      

        height:100vh;      
        overflow:hidden;      
    }      

    /* ====================== CARD LOGIN ===================== */      
    .card {      
        width:100%;      
        max-width:360px;      
        padding:28px 26px;      
        border-radius:22px;      
        background:rgba(255,255,255,0.55);      
        backdrop-filter:blur(18px);      
        box-shadow:0 8px 28px rgba(0,0,0,0.10);      
        box-sizing:border-box;      
    }      

    h2 {      
        text-align:center;      
        font-size:22px;      
        font-weight:600;      
        margin:0 0 20px 0;      
    }      

    /* ======================== INPUT ======================== */      
    input {      
        width:100%;      
        padding:14px 16px;      
        border-radius:12px;      
        border:1px solid #d1d5db;      
        font-size:15px;      
        margin-bottom:15px;      
        box-sizing:border-box;      
        text-align:center;      
    }      
    input::placeholder {      
        color:#9ca3af;      
        text-align:center;      
    }      

    /* ======================== BUTTON ======================== */      
    button {      
        width:100%;      
        padding:14px;      
        border-radius:12px;      
        border:none;      
        font-size:15px;      
        font-weight:600;      
        cursor:pointer;      
        transition:0.15s;      
        position:relative;      
    }      

    .btn-green {      
        background:#22c55e;      
        color:white;      
    }      
    .btn-green:active {      
        background:#16a34a;      
    }      

    .link {      
        margin-top:10px;      
        text-align:center;      
        font-size:14px;      
        color:#22c55e;      
        cursor:pointer;      
        font-weight:500;      
    }      

    /* ======================== MODAL ======================== */      
    .modal-bg {      
        position:fixed;      
        inset:0;      
        display:none;      
        justify-content:center;      
        align-items:center;      
        background:rgba(0,0,0,0.35);      
        backdrop-filter:blur(12px);      
        padding:20px;      
        box-sizing:border-box;      
    }      

    .modal {      
        background:white;      
        width:100%;      
        max-width:360px;      
        padding:26px;      
        border-radius:20px;      
        box-shadow:0 8px 22px rgba(0,0,0,0.12);      
        animation:slideUp .25s ease;      
        box-sizing:border-box;      
    }      

    @keyframes slideUp {      
        from { transform:translateY(20px); opacity:0; }      
        to   { transform:translateY(0); opacity:1; }      
    }      

    .close-btn {      
        text-align:right;      
        font-weight:600;      
        color:#ef4444;      
        cursor:pointer;      
        margin-bottom:10px;      
    }      

    /* ===================================================== */      
    /*                     BEAUTIFUL TOAST                   */      
    /* ===================================================== */      
    .toast-box {      
        position: fixed;      
        top: -90px;      
        left: 50%;      
        transform: translateX(-50%);      
        min-width: 240px;      
        max-width: 90%;      
        padding: 14px 20px;      
        border-radius: 14px;      
        display: flex;      
        align-items: center;      
        gap: 10px;      
        color: white;      
        font-size: 15px;      
        font-weight: 600;      
        box-shadow: 0 8px 28px rgba(0,0,0,0.18);      
        opacity: 0;      
        transition: all .45s ease;      
        z-index: 9999;      
    }      
    .toast-box.show {      
        top: 25px;      
        opacity: 1;      
    }      
    .toast-icon {      
        width: 26px;      
        height: 26px;      
        border-radius: 50%;      
        display:flex;      
        justify-content:center;      
        align-items:center;      
        font-size: 14px;      
        background: rgba(255,255,255,0.25);      
    }      
    .toast-success { background: linear-gradient(135deg,#22c55e,#16a34a); }      
    .toast-error   { background: linear-gradient(135deg,#ef4444,#dc2626); }      
    .toast-info    { background: linear-gradient(135deg,#3b82f6,#2563eb); }      

    /* ===================================================== */      
    /*                     WATERMARK LOGIN                   */      
    /* ===================================================== */      
    .watermark {    
        margin-top: 18px;    
        text-align: center;    
        font-size: 13px;    
        color: #6b7280;    
        opacity: 0.7;    
        line-height: 1.4;    
    }    
    .watermark span {    
        font-weight: 600;    
        color: #4c82ff;    
    }    
    .watermark .version {    
        font-size: 12px;    
        opacity: 0.9;    
    }    

    /* ======================== LOADING ======================== */
    .loading-overlay {
        position: fixed;
        inset: 0;
        background: rgba(255,255,255,0.85);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 9998;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }
    .loading-overlay.show {
        opacity: 1;
        pointer-events: all;
    }
    .loading-spinner {
        border: 5px solid #f3f3f3;
        border-top: 5px solid #22c55e;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin-bottom: 15px;
    }
    .loading-text {
        font-size: 16px;
        color: #22c55e;
        font-weight: 600;
    }
    @keyframes spin {
        0% { transform: rotate(0deg);}
        100% { transform: rotate(360deg);}
    }
</style>      
</head>      

<body>      

<!-- ======================== LOADING ======================== -->
<div id="loading" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Sedang memproses...</div>
</div>

<!-- ======================== TOAST ======================== -->      
<div id="toast" class="toast-box">      
    <div class="toast-icon">ℹ️</div>      
    <div id="toastMsg">Pesan masuk di sini</div>      
</div>      

<!-- ======================== LOGIN CARD ======================== -->      
<div class="card">      
    <h2>Dollar App</h2>      

    <input id="loginEmail" type="email" placeholder="Email">      
    <input id="loginPassword" type="password" placeholder="Password">      

    <button class="btn-green" onclick="doLogin()">Masuk</button>      

    <div class="link" onclick="openForgot()">Lupa password?</div>      
    <div class="link" onclick="openRegister()">Belum punya akun? Daftar</div>      
</div>      

<!-- ======================== WATERMARK ======================== -->      
<div class="watermark">    
    © Powered by <span>PP Daruttauhid Al Alawi</span>    
    <div class="version">Version 5.11</div>    
</div>    

<!-- ======================== REGISTER MODAL ======================== -->      
<div id="modalRegister" class="modal-bg">      
    <div class="modal">      
        <div class="close-btn" onclick="closeRegister()">✕ Tutup</div>      
        <h2>Daftar Akun</h2>      
        <input id="regEmail" type="email" placeholder="Email">      
        <input id="regPassword" type="password" placeholder="Password">      
        <button class="btn-green" onclick="doRegister()">Daftar</button>      
    </div>      
</div>      

<!-- ======================== FORGOT MODAL ======================== -->      
<div id="modalForgot" class="modal-bg">      
    <div class="modal">      
        <div class="close-btn" onclick="closeForgot()">✕ Tutup</div>      
        <h2>Reset Password</h2>      
        <input id="forgotEmail" type="email" placeholder="Masukkan email anda">      
        <button class="btn-green" onclick="doForgot()">Kirim Link Reset</button>      
    </div>      
</div>      

<!-- ======================== FIREBASE LOGIC ======================== -->      
<script type="module">      
import {      
    auth,      
    db,      
    signInWithEmailAndPassword,      
    createUserWithEmailAndPassword,      
    sendPasswordResetEmail,      
    doc, setDoc      
} from "./firebase.js";      

/* ====================== BEAUTIFUL TOAST ====================== */      
window.showToast = (msg, type = "info") => {      
    const toast = document.getElementById("toast");      
    const msgBox = document.getElementById("toastMsg");      
    const iconBox = toast.querySelector(".toast-icon");      
    msgBox.textContent = msg;      
    toast.className = "toast-box";      

    if (type === "success") {      
        toast.classList.add("toast-success");      
        iconBox.textContent = "✔";      
    }      
    else if (type === "error") {      
        toast.classList.add("toast-error");      
        iconBox.textContent = "✖";      
    }      
    else {      
        toast.classList.add("toast-info");      
        iconBox.textContent = "ℹ️";      
    }      

    toast.classList.add("show");      
    setTimeout(() => toast.classList.remove("show"), 3000);      
};      

/* ======================== LOADING CONTROL ====================== */
const showLoading = () => document.getElementById("loading").classList.add("show");
const hideLoading = () => document.getElementById("loading").classList.remove("show");

/* =========================== LOGIN ========================== */      
window.doLogin = async () => {      
    const email = loginEmail.value.trim();      
    const pass  = loginPassword.value.trim();      
    if (!email || !pass) return showToast("Email & password wajib diisi", "error");      

    showLoading();
    try {      
        await signInWithEmailAndPassword(auth, email, pass);      
        showToast("Login berhasil!", "success");      
        setTimeout(() => window.location.href = "dashboard.html", 900);      
    } catch {      
        showToast("Email / password salah", "error");      
    } finally {
        hideLoading();
    }      
};      

/* ========================== REGISTER ======================== */      
window.doRegister = async () => {      
    const email = regEmail.value.trim();      
    const pass  = regPassword.value.trim();      
    if (!email || !pass) return showToast("Isi semua field", "error");      

    showLoading();
    try {      
        const userCred = await createUserWithEmailAndPassword(auth, email, pass);      
        await setDoc(doc(db, "users", userCred.user.uid), {      
            email: email,      
            createdAt: Date.now()      
        });      
        showToast("Pendaftaran berhasil!", "success");      
        closeRegister();      
    } catch {      
        showToast("Gagal daftar", "error");      
    } finally {
        hideLoading();
    }      
};      

/* ======================= RESET PASSWORD ====================== */      
window.doForgot = async () => {      
    const email = forgotEmail.value.trim();      
    if (!email) return showToast("Email wajib diisi", "error");      

    showLoading();
    try {      
        await sendPasswordResetEmail(auth, email);      
        showToast("Link reset dikirim!", "info");      
        closeForgot();      
    } catch {      
        showToast("Email tidak ditemukan", "error");      
    } finally {
        hideLoading();
    }      
};      

/* ========================= MODAL CONTROL ====================== */      
window.openRegister = () => modalRegister.style.display = "flex";      
window.closeRegister = () => modalRegister.style.display = "none";      

window.openForgot = () => modalForgot.style.display = "flex";      
window.closeForgot = () => modalForgot.style.display = "none";      
</script>      

</body>      
</html>